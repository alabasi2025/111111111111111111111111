# وثيقة نشر النظام (Deployment Guide)

**المهمة 20: إعداد وثيقة النشر**

---

## 1. مقدمة

تهدف هذه الوثيقة إلى شرح عملية نشر (Deployment) النظام البرمجي بشكل مفصل، مع التركيز على منهجية **التثبيت الآلي الكامل والمستقل (Full Standalone Automated Installation)** التي تعتمد على برنامج تنفيذي واحد صالح للاستخدام مرة واحدة فقط.

تم تصميم عملية النشر لضمان:
*   **الأتمتة الكاملة**: لا يتطلب التثبيت أي تدخل يدوي باستثناء تشغيل الملف التنفيذي.
*   **الأمان**: استخدام مثبتات صالحة للاستخدام مرة واحدة (Single-Use Installer) لتقييد الوصول.
*   **الاستقلالية**: المثبت لا يتطلب اتصالاً بالإنترنت لتنزيل المكونات الأساسية (Standalone).
*   **الفصل الواضح**: توفير مسارات نشر منفصلة للعميل والمطور.

---

## 2. متطلبات النشر الأساسية (Prerequisites)

لضمان نجاح عملية النشر، يجب استيفاء المتطلبات التالية:

| المتطلب | الوصف | ملاحظات |
| :--- | :--- | :--- |
| **نظام التشغيل** | Windows 10/11 (64-bit) أو Linux (توزيعة محددة) | يجب أن يتوافق مع بيئة التشغيل المستهدفة. |
| **الموارد** | 8 جيجابايت RAM كحد أدنى، 50 جيجابايت مساحة تخزين حرة. | تختلف حسب حجم النظام والمكونات المثبتة. |
| **الصلاحيات** | صلاحيات المسؤول (Administrator/Root) لتشغيل المثبت. | ضرورية لتثبيت الخدمات والمكونات الأساسية. |
| **قاعدة البيانات** | (لبيئة المطور فقط) يجب توفر بيئة قاعدة بيانات (مثل PostgreSQL/MySQL) جاهزة للتهيئة. | يتم تهيئتها تلقائيًا بواسطة مثبت المطور. |

---

## 3. آليات النشر والتحديث

يعتمد النظام على منهجية صارمة ومتحكم بها للنشر والتحديث:

### 3.1. برنامج التثبيت التنفيذي (The Executable Installer)

يتم توفير نوعين من برامج التثبيت، وكلاهما يتبع مبدأ **المثبت الصالح للاستخدام مرة واحدة (Single-Use Installer)** [1]:

1.  **مثبت العميل (Client Installer)**:
    *   يحتوي على المكونات الأساسية اللازمة لتشغيل النظام واستخدام واجهة المستخدم النهائية.
    *   لا يتضمن أدوات المطور أو واجهات برمجة التطبيقات (APIs) الداخلية.
    *   يتم إبطال صلاحيته تلقائيًا بعد اكتمال عملية التثبيت بنجاح.

2.  **مثبت المطور (Developer/Full Features Installer)**:
    *   يحتوي على جميع مكونات النظام، بما في ذلك بيئة التطوير، واجهات المطور، وأدوات إدارة قاعدة البيانات.
    *   يستخدم لنشر بيئات التطوير أو الاختبار (Staging/Testing).
    *   يتم إبطال صلاحيته تلقائيًا بعد اكتمال عملية التثبيت بنجاح.

> **ملاحظة أمنية**: عند الحاجة إلى إعادة التثبيت أو التحديث، يجب طلب ملف تنفيذي جديد من فريق التطوير.

### 3.2. عملية التثبيت الآلي الكامل (One-Click Automated Installation)

تم تصميم المثبت ليكون **مستقلاً وكاملاً (Full Standalone)**، حيث يقوم بتنفيذ جميع الخطوات تلقائيًا [2]:

1.  **الفحص الأولي للنظام**: يقوم المثبت بفحص جميع المتطلبات الأساسية (الذاكرة، المساحة، الصلاحيات).
2.  **التثبيت الانتقائي للمتطلبات**: في حال وجود متطلبات ناقصة (مثل مكتبات نظام التشغيل)، يقوم المثبت بتثبيتها تلقائيًا.
3.  **تثبيت المكونات الأساسية**: تثبيت خادم الويب، بيئة التشغيل (Runtime)، والخدمات الخلفية.
4.  **تهيئة قاعدة البيانات**: (لبيئة المطور) إنشاء الجداول، تطبيق الهجرات (Migrations)، وإدخال البيانات الأولية.
5.  **إعداد التهيئة (Configuration)**: إنشاء ملفات التهيئة اللازمة (مثل متغيرات البيئة) وتشفير البيانات الحساسة.
6.  **تشغيل الخدمات**: بدء تشغيل جميع خدمات النظام كخدمات نظام تشغيل (Services).
7.  **التحقق النهائي**: إجراء فحص ذاتي للتأكد من أن جميع الخدمات تعمل بشكل صحيح وأن النظام جاهز للاستخدام.
8.  **فتح واجهة المستخدم**: فتح واجهة المستخدم النهائية في المتصفح الافتراضي (لبيئة العميل) أو واجهة المطور (لبيئة المطور).

### 3.3. آلية التحديث (Update Mechanism)

تتم إدارة التحديثات من خلال نفس البرنامج التنفيذي، ولكن يتم إرسال نسخة جديدة منه عند كل تحديث رئيسي [3]:

1.  **إنشاء ملفات التحديث**: يتم إنشاء ملفات تحديث (Update Files) تحتوي على التغييرات الجديدة.
2.  **النشر المتحكم به (Controlled Deployment)**: يتم اختبار ملفات التحديث أولاً على **قاعدة بيانات منفصلة ومحاكاة لبيئة العميل (Simulated Client Database)** لضمان عدم وجود تعارضات [4].
3.  **تزويد العميل بالمثبت الجديد**: يتم تزويد العميل ببرنامج تنفيذي جديد (Single-Use Installer) يحتوي على التحديثات المدمجة.
4.  **تنفيذ التحديث**: عند تشغيل المثبت الجديد، فإنه يتعرف على وجود تثبيت سابق ويقوم بتطبيق التحديثات اللازمة (مثل هجرات قاعدة البيانات) بشكل آلي.

---

## 4. إجراءات النشر للمطورين (Developer Deployment)

تتطلب بيئة المطور خطوات إضافية لضمان بيئة عمل متكاملة:

### 4.1. الحصول على المثبت

يتم الحصول على **مثبت المطور (Developer Installer)** من فريق التطوير.

### 4.2. تشغيل المثبت

```bash
# تشغيل المثبت بصلاحيات المسؤول
.\Developer_Installer_vX.Y.Z_SingleUse.exe
```

*   سيقوم المثبت بتثبيت جميع المكونات، بما في ذلك بيئة التطوير (مثل Node.js، Python، Docker).
*   سيتم استنساخ مستودعات الشفرة المصدر (Source Code Repositories) إلى مسار محدد (افتراضياً: `C:\ProjectName\`).

### 4.3. إعداد بيئة العمل

بعد اكتمال التثبيت، يمكن للمطورين الانتقال إلى مجلد المشروع وبدء العمل:

```bash
cd C:\ProjectName\unified-frontend-monorepo
# تثبيت التبعيات
pnpm install
# تشغيل بيئة التطوير
pnpm dev
```

### 4.4. مزامنة مشاكل التثبيت

يحتوي المثبت على آلية لمزامنة أي مشاكل أو أخطاء تحدث أثناء عملية التثبيت مع النظام لتسهيل عملية تحديد المشكلة وحلها [5].

---

## 5. إجراءات النشر للعملاء (Client Deployment)

تتميز عملية نشر العميل بالبساطة والأتمتة الكاملة:

### 5.1. الحصول على المثبت

يتم تزويد العميل بـ **مثبت العميل (Client Installer)** عبر رابط مباشر.

> **تفضيل التوزيع**: يفضل استخدام حساب التخزين السحابي الشخصي للمستخدم (مثل OneDrive) كمصدر لملفات التثبيت، ويتم التعامل مع عملية الرفع آليًا من قبل الوكيل [6].

### 5.2. تشغيل المثبت

```bash
# تشغيل المثبت بصلاحيات المسؤول
.\Client_Installer_vX.Y.Z_SingleUse.exe
```

*   بمجرد التشغيل، سيتولى المثبت جميع المهام دون الحاجة لأي تدخل.
*   بعد الانتهاء، سيتم فتح واجهة النظام في المتصفح، ويكون النظام جاهزًا للاستخدام.

---

## 6. المراجع (References)

[1] تفضيل برنامج تثبيت صالح للاستخدام مرة واحدة فقط (Single-Use Installer)
[2] تفضيل برنامج تنفيذي واحد ومستقل للتثبيت الآلي الكامل للنظام (One-Click Automated Installation)
[3] تفضيل برنامج تنفيذي واحد ومستقل وكامل للتثبيت الآلي (Full Standalone Installer) وعدم استخدام مثبت صغير يتصل بالإنترنت أو التخزين السحابي الشخصي كمصدر للملفات، وإرسال نفس البرنامج التنفيذي للعميل عند كل تحديث.
[4] منهجية إنشاء قاعدة بيانات منفصلة للعميل وملفات تحديث قابلة للتثبيت والفحص قبل النشر (Controlled Deployment and Update Methodology)
[5] منهجية مزامنة مشاكل التثبيت (Installation Issues Synchronization) مع النظام لتسهيل الحل
[6] تفضيل التعامل الآلي مع رفع ملفات التثبيت والتحديث إلى حساب التخزين السحابي للمستخدم وتوفير رابط مباشر للبرنامج التنفيذي